$OpenBSD: patch-salt_returners_nagios_nrdp_return_py,v 1.1 2020/07/15 10:29:16 florian Exp $
cgi.escape has been deprecated since python 3.2 and removed in 3.8.

Index: salt/returners/nagios_nrdp_return.py
--- salt/returners/nagios_nrdp_return.py.orig
+++ salt/returners/nagios_nrdp_return.py
@@ -51,7 +51,7 @@ To override individual configuration items, append --r
 from __future__ import absolute_import, print_function, unicode_literals
 
 # Import python libs
-import cgi
+import html
 import logging
 
 import salt.ext.six.moves.http_client
@@ -125,20 +125,20 @@ def _prepare_xml(options=None, state=None):
             + six.text_type(options["checktype"])
             + "'>"
         )
-        xml += "<hostname>" + cgi.escape(options["hostname"], True) + "</hostname>"
-        xml += "<servicename>" + cgi.escape(options["service"], True) + "</servicename>"
+        xml += "<hostname>" + html.escape(options["hostname"]) + "</hostname>"
+        xml += "<servicename>" + html.escape(options["service"]) + "</servicename>"
     else:
         xml += (
             "<checkresult type='host' checktype='"
             + six.text_type(options["checktype"])
             + "'>"
         )
-        xml += "<hostname>" + cgi.escape(options["hostname"], True) + "</hostname>"
+        xml += "<hostname>" + html.escape(options["hostname"]) + "</hostname>"
 
     xml += "<state>" + _state + "</state>"
 
     if "output" in options:
-        xml += "<output>" + cgi.escape(options["output"], True) + "</output>"
+        xml += "<output>" + html.escape(options["output"]) + "</output>"
 
     xml += "</checkresult>"
 
